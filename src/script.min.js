const fileElement=document.getElementById("csv-data");function createTable(e,t){results.innerHTML="";let l=document.createElement("table");l.className="table table-striped",results.appendChild(l);let n=document.createElement("thead");l.appendChild(n);let a=document.createElement("tr");n.appendChild(a),a.appendChild(document.createElement("td"));let d=document.createElement("tbody");l.appendChild(d);let r=new Map;t.forEach(e=>{let t=document.createElement("tr"),l=document.createElement("th");l.textContent=e,t.appendChild(l),d.appendChild(t),r.set(e,t)});let c=document.createElement("tr"),p=document.createElement("th");p.textContent="Total",c.appendChild(p),d.appendChild(c);let o=Object.keys(e);o.forEach(l=>{let n=document.createElement("th");n.textContent=l,a.appendChild(n);let d=0;t.forEach(t=>{let n=document.createElement("td");n.textContent=e[l]?.[t]??"",d+=e[l]?.[t]??0,r.get(t).appendChild(n)});let p=document.createElement("td");p.textContent=d,c.appendChild(p)})}fileElement.addEventListener("input",e=>{let t=document.getElementById("csv-data").files[0],l=new FileReader;l.onload=function(e){let t=$.csv.toObjects(l.result),n={},a=new Set;t.forEach(e=>{let t=e["Work date"].split(" ")[0];n[t]||(n[t]={});let l=e["Tenrox Project"]?e["Tenrox Project"]:"Global";a.add(l),n[t][l]||(n[t][l]=0),n[t][l]+=parseFloat(e.Hours)}),createTable(n,a)},l.readAsText(t)});